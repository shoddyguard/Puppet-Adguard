# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

* [`adguard`](#adguard): Manages an Adguard Home installation

### Data types

* [`Adguard::Blocked_service`](#adguardblocked_service): A list of services that AdGuard Home is able to block out of the box.

## Classes

### <a name="adguard"></a>`adguard`

Manages an Adguard Home installation

#### Parameters

The following parameters are available in the `adguard` class:

* [`webui_interface`](#webui_interface)
* [`webui_port`](#webui_port)
* [`users`](#users)
* [`http_proxy`](#http_proxy)
* [`rlimit_nofile`](#rlimit_nofile)
* [`debug_pprof`](#debug_pprof)
* [`web_session_ttl`](#web_session_ttl)
* [`dns_interface`](#dns_interface)
* [`dns_port`](#dns_port)
* [`statistics_interval`](#statistics_interval)
* [`querylog_enabled`](#querylog_enabled)
* [`querylog_file_enabled`](#querylog_file_enabled)
* [`querylog_interval`](#querylog_interval)
* [`querylog_size_memory`](#querylog_size_memory)
* [`anonymize_client_ip`](#anonymize_client_ip)
* [`protection_enabled`](#protection_enabled)
* [`blocking_mode`](#blocking_mode)
* [`blocking_ipv4`](#blocking_ipv4)
* [`blocking_ipv6`](#blocking_ipv6)
* [`blocked_response_ttl`](#blocked_response_ttl)
* [`parental_block_host`](#parental_block_host)
* [`safebrowsing_block_host`](#safebrowsing_block_host)
* [`ratelimit`](#ratelimit)
* [`ratelimit_whitelist`](#ratelimit_whitelist)
* [`refuse_any`](#refuse_any)
* [`upstream_dns`](#upstream_dns)
* [`upstream_dns_file`](#upstream_dns_file)
* [`bootstrap_dns`](#bootstrap_dns)
* [`all_servers`](#all_servers)
* [`fastest_addr`](#fastest_addr)
* [`allowed_clients`](#allowed_clients)
* [`disallowed_clients`](#disallowed_clients)
* [`blocked_hosts`](#blocked_hosts)
* [`dns_cache_size`](#dns_cache_size)
* [`dns_cache_ttl_min`](#dns_cache_ttl_min)
* [`dns_cache_ttl_max`](#dns_cache_ttl_max)
* [`bogus_nxdomain`](#bogus_nxdomain)
* [`aaaa_disabled`](#aaaa_disabled)
* [`enable_dnssec`](#enable_dnssec)
* [`edns_client_subnet`](#edns_client_subnet)
* [`max_goroutines`](#max_goroutines)
* [`filtering_enabled`](#filtering_enabled)
* [`filters_update_interval`](#filters_update_interval)
* [`parental_enabled`](#parental_enabled)
* [`safesearch_enabled`](#safesearch_enabled)
* [`safebrowsing_enabled`](#safebrowsing_enabled)
* [`safebrowsing_cache_size`](#safebrowsing_cache_size)
* [`safesearch_cache_size`](#safesearch_cache_size)
* [`parental_cache_size`](#parental_cache_size)
* [`cache_time`](#cache_time)
* [`rewrites`](#rewrites)
* [`blocked_services`](#blocked_services)
* [`filters`](#filters)
* [`whitelist_filters`](#whitelist_filters)
* [`user_rules`](#user_rules)
* [`clients`](#clients)
* [`log_compress`](#log_compress)
* [`log_localtime`](#log_localtime)
* [`log_max_backups`](#log_max_backups)
* [`log_max_size`](#log_max_size)
* [`log_max_age`](#log_max_age)
* [`log_file`](#log_file)
* [`verbose_logging`](#verbose_logging)
* [`adguard_path`](#adguard_path)
* [`manage_config`](#manage_config)
* [`configuration_file`](#configuration_file)
* [`service_name`](#service_name)
* [`version`](#version)

##### <a name="webui_interface"></a>`webui_interface`

Data type: `Stdlib::IP::Address::V4::Nosubnet`

The interface to bind the WebUI to.
Default: 0.0.0.0 (all interfaces)

##### <a name="webui_port"></a>`webui_port`

Data type: `Stdlib::Port`

The port to bind the WebUI to.
Default: 80

##### <a name="users"></a>`users`

Data type: `Tuple[Struct[
    username => String,
    password => String
  ],1,default]`

The users to add to the WebUI in an array of hashes.
`[{username => 'user', password => '$2a$10$DBX2KdCRP6JKS8TqvkVWTOjUgUQLtlWGkxkZAuiUZGTURhorjlX6K'}]`
Note: the password needs to be in BCrypt-encrypted format, to get a password: `htpasswd -bnBC 10 "" MY_NEW_PASS | tr -d ':'`

##### <a name="http_proxy"></a>`http_proxy`

Data type: `Optional[Stdlib::HTTPUrl]`

Define an optional http_proxy, while adguard supports SOCKS5 alongside HTTP/S, this is **not** supported in the Puppet module at this time.
Default: undef

##### <a name="rlimit_nofile"></a>`rlimit_nofile`

Data type: `Integer`

Limit on the maximum number of open files for server process (Linux).
Default: 0 (use system default)

##### <a name="debug_pprof"></a>`debug_pprof`

Data type: `Boolean`

Enable pprof HTTP server listening on port 6060 for debugging.
Default: false

##### <a name="web_session_ttl"></a>`web_session_ttl`

Data type: `Integer`

Web session TTL (in hours) a web user will stay signed in for this amount of time.
Default: 8

##### <a name="dns_interface"></a>`dns_interface`

Data type: `Stdlib::IP::Address::V4::Nosubnet`

The interface to bind to for DNS.
Default: 0.0.0.0 (all interfaces)

##### <a name="dns_port"></a>`dns_port`

Data type: `Stdlib::Port`

The port to bind dns to, defaults to 53.
Note: if you're on a systemd OS and you're binding to port 53 AdGuard won't be able to start due to resolved's DNSStubListener
as such DNSStubListener will be disabled in /etc/systemd/resolved.conf, this WILL break name resolution when there's no DNS server running locally.

##### <a name="statistics_interval"></a>`statistics_interval`

Data type: `Integer`

Time interval for statistics (in days).
Default: 1

##### <a name="querylog_enabled"></a>`querylog_enabled`

Data type: `Boolean`

Query logging (also used to calculate top 50 clients, blocked domains and requested domains for statistical purposes).
Default: true

##### <a name="querylog_file_enabled"></a>`querylog_file_enabled`

Data type: `Boolean`

Write query logs to a file.
Default: true

##### <a name="querylog_interval"></a>`querylog_interval`

Data type: `Integer`

Time interval for query log (in days).
Default: 90

##### <a name="querylog_size_memory"></a>`querylog_size_memory`

Data type: `Integer`

Number of entries kept in memory before they are flushed to disk.
Default: 1000

##### <a name="anonymize_client_ip"></a>`anonymize_client_ip`

Data type: `Boolean`

If true, anonymize clients' IP addresses in logs and stats.
Default: false

##### <a name="protection_enabled"></a>`protection_enabled`

Data type: `Boolean`

Whether any kind of filtering and protection should be done, when off it works as a plain dns forwarder.
Default: to true

##### <a name="blocking_mode"></a>`blocking_mode`

Data type: `Enum['default','null_ip','custom_ip']`

Specifies how to block DNS requests.
Valid options:
  - default (respond with NXDOMAIN status)
  - null_ip (respond with the unspecified IP address (0.0.0.0))
  - custom_ip (respond with blocking_ipv4 or blocking_ipv6 address)
Default: default

##### <a name="blocking_ipv4"></a>`blocking_ipv4`

Data type: `Optional[Stdlib::IP::Address::V4::Nosubnet]`

IP address to be returned for a blocked A request if blocking_mode is set to custom_ip.
Default: undef

##### <a name="blocking_ipv6"></a>`blocking_ipv6`

Data type: `Optional[Stdlib::IP::Address::V6]`

IP address to be returned for a blocked AAAA request if blocking_mode is set to custom_ip.
Default: undef

##### <a name="blocked_response_ttl"></a>`blocked_response_ttl`

Data type: `Integer`

For how many seconds the clients should cache a filtered response. Low values are useful on LAN if you change filters very often, high values are useful to increase performance and save traffic.
Default: 10

##### <a name="parental_block_host"></a>`parental_block_host`

Data type: `Variant[Stdlib::Fqdn,Stdlib::IP::Address]`

IP (or domain name) which is used to respond to DNS requests blocked by parental control.
Default: family-block.dns.adguard.com

##### <a name="safebrowsing_block_host"></a>`safebrowsing_block_host`

Data type: `Variant[Stdlib::Fqdn,Stdlib::IP::Address]`

IP (or domain name) which is used to respond to DNS requests blocked by safe-browsing.
Default: standard-block.dns.adguard.com

##### <a name="ratelimit"></a>`ratelimit`

Data type: `Integer`

DDoS protection, specifies in how many packets per second a client should receive. Anything above that is silently dropped. To disable set 0, default is 20. Safe to disable if DNS server is not available from internet.
Default: 20

##### <a name="ratelimit_whitelist"></a>`ratelimit_whitelist`

Data type: `Optional[Tuple[Stdlib::IP::Address,1,default]]`

An array of ip addresses to whitelist from ratelimiting.
Default: undef

##### <a name="refuse_any"></a>`refuse_any`

Data type: `Boolean`

Another DDoS protection mechanism. Requests of type ANY are rarely needed, so refusing to serve them mitigates against attackers trying to use your DNS as a reflection. Safe to disable if DNS server is not available from internet.
Default: true

##### <a name="upstream_dns"></a>`upstream_dns`

Data type: `Tuple[Variant[Stdlib::IP::Address,Stdlib::HTTPUrl],1,4]`

An array of upstream DNS servers. Can be a URL or IP.

##### <a name="upstream_dns_file"></a>`upstream_dns_file`

Data type: `Optional[Stdlib::Unixpath]`

Path to a file with the list of upstream DNS servers. If it is configured, the value of upstream_dns is ignored. Defaults to undef

##### <a name="bootstrap_dns"></a>`bootstrap_dns`

Data type: `Tuple[Stdlib::IP::Address,1,default]`

List of DNS servers used for initial hostname resolution in case an upstream server name is a hostname.
Default:
  - 9.9.9.9
  - 8.8.8.8
  - 2620:fe::fe
  - 2620:fe::9

##### <a name="all_servers"></a>`all_servers`

Data type: `Boolean`

Enables parallel queries to all configured upstream servers to speed up resolving. If disabled, the queries are sent to each upstream server one-by-one and then sorted by RTT.
Default: false

##### <a name="fastest_addr"></a>`fastest_addr`

Data type: `Boolean`

Use Fastest Address algorithm. It finds an IP address with the lowest latency and returns this IP address in DNS response.
Default: false

##### <a name="allowed_clients"></a>`allowed_clients`

Data type: `Optional[Tuple[Stdlib::IP::Address,1,default]]`

IP addresses of allowed clients.
Default: undef

##### <a name="disallowed_clients"></a>`disallowed_clients`

Data type: `Optional[Tuple[Stdlib::IP::Address,1,default]]`

IP addresses of disallowed clients.
Default: undef

##### <a name="blocked_hosts"></a>`blocked_hosts`

Data type: `Array`

An array of hosts to block.
Default: undef

##### <a name="dns_cache_size"></a>`dns_cache_size`

Data type: `Integer`

DNS cache size (in bytes).
Default: 4194304

##### <a name="dns_cache_ttl_min"></a>`dns_cache_ttl_min`

Data type: `Integer[default,3600]`

Override TTL value (minimum) received from upstream server. This value can't larger than 3600 (1 hour).
Default: 0 (do not override)

##### <a name="dns_cache_ttl_max"></a>`dns_cache_ttl_max`

Data type: `Integer[default,3600]`

Override TTL value (maximum) received from upstream server.
Default: 0 (do not override)

##### <a name="bogus_nxdomain"></a>`bogus_nxdomain`

Data type: `Optional[Tuple[Stdlib::Fqdn,Stdlib::IP::Address::V4::Nosubnet,1,default]]`

Optional - Transform responses with these IP addresses to NXDOMAIN

##### <a name="aaaa_disabled"></a>`aaaa_disabled`

Data type: `Boolean`

Respond with an empty answer to all AAAA requests
Default: false

##### <a name="enable_dnssec"></a>`enable_dnssec`

Data type: `Boolean`

Set DNSSEC flag in the outgoing DNS requests and check the result.
Note if running an additional DNS server (such as Unbound or BIND) that uses DNSSEC you do not want DNSSEC on both as you will get erroes with legitimate DNS requests.
Default: false

##### <a name="edns_client_subnet"></a>`edns_client_subnet`

Data type: `Boolean`

Enable EDNS Client Subnet option. If enabled, AdGuard Home will be sending ECS extension to the upstream DNS servers. Please note, that this will be done for clients with public IP addresses only.
Default: false

##### <a name="max_goroutines"></a>`max_goroutines`

Data type: `Integer`

Max. number of parallel goroutines for processing incoming requests
Default: 300

##### <a name="filtering_enabled"></a>`filtering_enabled`

Data type: `Boolean`

Filtering of DNS requests based on filter lists.
Default: true

##### <a name="filters_update_interval"></a>`filters_update_interval`

Data type: `Integer`

How often the filters update (in hours).
Default: 24.

##### <a name="parental_enabled"></a>`parental_enabled`

Data type: `Boolean`

Parental control-based DNS requests filtering
Default: false

##### <a name="safesearch_enabled"></a>`safesearch_enabled`

Data type: `Boolean`

Enforcing "Safe search" option for search engines, when possible.
Default: false

##### <a name="safebrowsing_enabled"></a>`safebrowsing_enabled`

Data type: `Boolean`

Filtering of DNS requests based on safebrowsing
Default: false

##### <a name="safebrowsing_cache_size"></a>`safebrowsing_cache_size`

Data type: `Integer`

Safe Browsing cache size (in bytes).
Default: 1048576

##### <a name="safesearch_cache_size"></a>`safesearch_cache_size`

Data type: `Integer`

Safe Search cache size (in bytes).
Default: 1048576

##### <a name="parental_cache_size"></a>`parental_cache_size`

Data type: `Integer`

Parental Control cache size (in bytes).
Default: 1048576

##### <a name="cache_time"></a>`cache_time`

Data type: `Integer`

Safe Browsing, Safe Search, Parental Control cache TTL.
Default: 30

##### <a name="rewrites"></a>`rewrites`

Data type: `Optional[Struct[
    domain => String,
    answer => String,
  ]]`

An array of custom rewrite rules
Format:
  domain: the domain to perform the rewrite on
  answer: the ip address to point to
Default: undef

##### <a name="blocked_services"></a>`blocked_services`

Data type: `Optional[Tuple[Adguard::Blocked_service,1,default]]`

An array of any services you wish to block.
Default: undef

##### <a name="filters"></a>`filters`

Data type: `Tuple[Struct[
    name => String,
    enabled => Boolean,
    url => Stdlib::HTTPUrl,
  ],1,default]`

An array of block filters to add.
Format
  name: the name for the filter (eg AdGuard Default)
  enabled: true/false
  url: the URL to point to
Default: the default list provided by AdGuard

##### <a name="whitelist_filters"></a>`whitelist_filters`

Data type: `Optional[Tuple[Struct[
    name => String,
    enabled => Boolean,
    url => Stdlib::HTTPUrl,
  ],1,default]]`

An array of whitelist filters to add.
  name: the name for the filter (eg AdGuard Default)
  enabled: true/false
  url: the URL to point to
Default: undef

##### <a name="user_rules"></a>`user_rules`

Data type: `Optional[Array]`

Any custom rules you'd like to define, optional.
Default: undef

##### <a name="clients"></a>`clients`

Data type: `Optional[Tuple[Struct[
    name => String,
    tags => Optional[Array],
    ids => Array,
    use_global_settings => Boolean,
    filtering_enabled => Optional[Boolean],
    parental_enabled  => Optional[Boolean],
    safesearch_enabled => Optional[Boolean],
    use_global_blocked_services => Boolean,
    blocked_services => Optional[Array],
    upstreams => Optional[Array]
  ],1,default]]`

EXPERIMENTAL: Individual client settings
Not extensively tested, please report any issues on the project repo.
Default: undef

##### <a name="log_compress"></a>`log_compress`

Data type: `Boolean`

Whether or not to compress the logs.
Default: false

##### <a name="log_localtime"></a>`log_localtime`

Data type: `Boolean`

Whether to format timestamps using computer's local time.
Default: false

##### <a name="log_max_backups"></a>`log_max_backups`

Data type: `Integer`

Maximum number of old log files to retain (MaxAge may still cause them to get deleted) (default: 0, which retains all old log files)
Defaults to 0.

##### <a name="log_max_size"></a>`log_max_size`

Data type: `Integer`

Maximum size in megabytes of the log file before it gets rotated.
Defaults: 100

##### <a name="log_max_age"></a>`log_max_age`

Data type: `Integer`

MaxAge is the maximum number of days to retain old log files.
Default: 3

##### <a name="log_file"></a>`log_file`

Data type: `Variant[Stdlib::Unixpath,Enum['syslog'],Undef]`

Path to the log file. If empty, writes to stdout, if syslog -- system log (or eventlog on Windows).
Valid options are: unixpath, undef or 'syslog'.
Default: undef

##### <a name="verbose_logging"></a>`verbose_logging`

Data type: `Boolean`

Enable or disable verbose logging. Defaults to false

##### <a name="adguard_path"></a>`adguard_path`

Data type: `Stdlib::Unixpath`

The path to where you'd like AdGuard installed, defaults to /opt/AdGuardHome

##### <a name="manage_config"></a>`manage_config`

Data type: `Boolean`

Whether or not to manage the AdGuardHome.yaml file
This is designed as a failsafe option (see Disabling configuration file management in the README)
If the the file format changes drastically in the future you can set this to false to stop Puppet fighting with AdGuardHome.
The initial configuration file will always be created by Puppet.
Default: true

##### <a name="configuration_file"></a>`configuration_file`

Data type: `Pattern[/(.*\/)(.*)(AdGuardHome.yaml$)/]`

The path to where you want to store the configuration file, must be a full path to AdGuardHome.yaml.
Default: a child of adguard::adguard_path

##### <a name="service_name"></a>`service_name`

Data type: `String`

The name of the service to manage, defaults to AdGuardHome

##### <a name="version"></a>`version`

Data type: `String`

The version to install from the GitHub release

## Data types

### <a name="adguardblocked_service"></a>`Adguard::Blocked_service`

A list of services that AdGuard Home is able to block out of the box.

Alias of

```puppet
Enum['9gag', 'amazon', 'cloudflare', 'dailymotion', 'discord', 'disneyplus', 'ebay', 'epic_games', 'facebook', 'hulu', 'imgur', 'instagram', 'mail_ru', 'netflix', 'ok', 'origin', 'pinterest', 'qq', 'reddit', 'skype', 'snapchat', 'spotify', 'steam', 'telegram', 'tiktok', 'tinder', 'twitch', 'twitter', 'viber', 'vimeo', 'vk', 'wechat', 'weibo', 'whatsapp', 'youtube']
```

